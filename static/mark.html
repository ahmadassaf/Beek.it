<!DOCTYPE html>
<html>
<head>
    <link id="siteicon" rel="icon" href="./img/beek.png"/>
    <title>beek.it</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript">
    function onLoad() {
      socialMarkUpdate(true);
    }
    function socialMarkUpdate(isMarked) {
        var evt = document.createEvent("CustomEvent");
        evt.initCustomEvent("socialMarkUpdate", true, true, JSON.stringify({marked: isMarked}));
        document.documentElement.dispatchEvent(evt);
        if(!isMarked) {
          $.get("http://beek.it/api/remove_url", {url: shareData.url});
        }
    }

    var shareData;
    addEventListener("OpenGraphData", function(e) {
      shareData = JSON.parse(e.detail);
      $.get("http://beek.it/api/add", {url: shareData.url});
      $("#shared").text(shareData.url);
      $("#data").html(JSON.stringify(e.detail, undefined, 2));
      socialMarkUpdate(true);
    });
    </script>
    <style type="text/css">
      #search-button {
        margin: 20px;
      }
      #close-button {
        position: absolute;
        top: 10px;
        left: 10px;
        width: 30px;
        cursor: pointer;
      }
      #unmark-button {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 30px;
        cursor: pointer;
      }
    </style>
</head>
<body onload="onLoad()" style="width: 330px; height: 130px; overflow: hidden;">
  <div id="content">
    <a href="http://beek.it" id="search-button" target="_blank"><img src="./img/open_beek.png"/ alt="Open beek.it"></a>
    <img id="unmark-button" src="./img/beek.png" onclick="socialMarkUpdate(false); window.close()"/>
    <img id="close-button" src="./img/close.png" alt="Close this window." onclick="window.close();"/>
  </div>
</body>
</html>
